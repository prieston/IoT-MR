(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{100:function(e,t,n){},102:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),r=n(8),a=n.n(r),c=(n(100),n(101),n(9)),d=(n(102),n(146)),l=n(12),s=n(34),u=n(11),m=n(33),w=n(1),p=n(70),f=n(71),v=n(62),b=n(60),h=function(e,t,n,i){return{Xb:e+n*Math.sin(i/63.6619772367581),Yb:t+n*Math.cos(i/63.6619772367581)}},g=function(e,t,n,i){var o,r=Math.abs(n-e),a=Math.abs(i-t),c=Math.sqrt(Math.pow(r,2)+Math.pow(a,2)),d=n-e,l=i-t,s=63.6619772367581*Math.atan(r/a);return d>0&&l>0?o=s:d>0&&l<0?o=200-s:d<0&&l<0?o=200+s:d<0&&l>0?o=400-s:0===d&&l>0?o=0:0===d&&l<0?o=200:d>0&&0===l?o=100:d<0&&0===l?o=300:0===d&&0===l&&(o=0),{Gab:Number(o.toFixed(4)),Sab:Number(c.toFixed(4))}},x=new w.Gb,y=new w.Gb(0,-1,0),E=new w.pb,j=function(e,t){var n,i,o=Number(t.object.position.x.toFixed(4)),r=Number(t.object.position.z.toFixed(4)),a=(null===(n=window.iotmr.selected.object)||void 0===n?void 0:n.uuid)==t.id?t.actions.onSelect:t.actions.onLoad,c=(null===(i=window.iotmr.selected.object)||void 0===i?void 0:i.uuid)==t.id?t.selectedRuntimeInfo:t.runtimeInfo;if(t.actions.onSelect===a){var d=Number(g(t.object.position.x,t.object.position.z,window.iotmr.camera.position.x,window.iotmr.camera.position.z).Gab),l=d?d/63.661977236758:0;t.object.rotation.set(t.rotation[0],t.rotation[1]+l,t.rotation[2])}var s=a.animations[c.animationIndex];if(c.duration+=e,c.lastUpdate+=e,s.duration){if(c.duration>=s.duration/1e3)if(c.duration=0,c.lastUpdate=0,a.animations.length-1>c.animationIndex){c.animationIndex++,c.pathIndex=0;var m=c.mixer;m.stopAllAction(),m.clipAction(t.object.children[0].animations.filter((function(e){return e.name==a.animations[c.animationIndex].name}))[0]).setDuration((s.singleLoopDuration||1e3)/1e3).play()}else{c.animationIndex=0,c.pathIndex=0;var w=c.mixer;w.stopAllAction(),w.clipAction(t.object.children[0].animations.filter((function(e){return e.name==a.animations[c.animationIndex].name}))[0]).setDuration((s.singleLoopDuration||1e3)/1e3).play()}return!1}var p=s.path[c.pathIndex],f=Number((p[0]-window.iotmr.center[0]).toFixed(4)),v=Number((p[2]-window.iotmr.center[2]).toFixed(4)),b=e*s.speed/60/60*1e3,j=s.path[c.pathIndex-1]?s.path[c.pathIndex-1]:s.path[c.pathIndex],I=g(j[0]-window.iotmr.center[0],j[2]-window.iotmr.center[2],f,v),O=I.Gab,S=I.Sab;if(O<=100&&o>=f&&r>=v||O>100&&O<=200&&o>=f&&r<=v||O>200&&O<=300&&o<=f&&r<=v||O>300&&o<=f&&r>=v){if(s.path.length-1>c.pathIndex)c.pathIndex++,c.duration=0,c.lastUpdate=0;else if(a.animations.length-1>c.animationIndex){c.animationIndex++,c.pathIndex=0,c.duration=0,c.lastUpdate=0;var k=c.mixer;k.stopAllAction(),k.clipAction(t.object.children[0].animations.filter((function(e){return e.name==a.animations[c.animationIndex].name}))[0]).setDuration((s.singleLoopDuration||1e3)/1e3).play()}else{c.animationIndex=0,c.pathIndex=0,c.duration=0,c.lastUpdate=0;var D=c.mixer;D.stopAllAction(),D.clipAction(t.object.children[0].animations.filter((function(e){return e.name==a.animations[c.animationIndex].name}))[0]).setDuration((s.singleLoopDuration||1e3)/1e3).play()}return{position:(a.animations[c.animationIndex].path[c.pathIndex-1]?a.animations[c.animationIndex].path[c.pathIndex-1]:a.animations[c.animationIndex].path[c.pathIndex]).reduce((function(e,t,n){return[].concat(Object(u.a)(e),[t-window.iotmr.center[n]])}),[])}}var A,W,M,R,C=h(o,r,b,O);if(s.dynamicHeight)c.lastUpdate=0,W={x:C.Xb,z:C.Yb,y:t.object.position.y},M=window.iotmr.world[window.iotmr.currentWorldId].filter((function(e){return 1==e.ground}))[0].object,R=3,x.set(W.x,W.y+R,W.z),E.set(x,y),A=((E.intersectObjects(M.children,!0)[0]||{}).point||{}).y||0;else{var N=s.path[c.pathIndex][1]-j[1],L=g(j[0]-window.iotmr.center[0],j[2]-window.iotmr.center[2],t.object.position.x,t.object.position.z).Sab/S;A=j[1]-window.iotmr.center[1]+N*L}var T=O?O/63.661977236758:0;return{position:[C.Xb,A,C.Yb],rotation:[t.rotation[0],t.rotation[1]+T,t.rotation[2]]}},I=n(55),O=function(e,t,n,i,o){function r(){t.style.textDecoration="line-through ",t.style.pointerEvents="none",t.onclick=null,t.style.textDecoration="line-through",t.style.pointerEvents="none"}if("xr"in navigator)return navigator.xr.isSessionSupported("immersive-vr").then((function(a){a?function(){var r=null;function a(t){window.session=t,t.addEventListener("end",c),e.xr.setSession(t);var n=i.position.x,a=i.position.z;i.position.set(0,0,0),o.rotation.set(0,0,0),i.rotation.y=-3.14,i.position.set(n,0,a),r=t}function c(){window.iotmr.realities.virtual(),r.removeEventListener("end",c),t.textContent="ENTER VR";var e=i.position.x,n=i.position.z;i.position.set(e,-1.7,n),o.position.set(0,0,0),o.rotation.set(0,0,0),i.rotation.y=0,i.position.y=-1.7,r=null}t.onclick=function(){if(null===r){navigator.xr.requestSession(n,{optionalFeatures:["local-floor","bounded-floor"]}).then(a)}else r.end()}}():r()})),t;var a=document.createElement("a");return a.href="https://immersiveweb.dev/",!1===window.isSecureContext?a.innerHTML="WEBXR NEEDS HTTPS":a.innerHTML="WEBXR NOT AVAILABLE",a.style.left="calc(50% - 90px)",a.style.width="180px",a.style.textDecoration="none",a},S=(Math.PI,function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t});S();function k(e,t,n,i,o,r,a,c,d,l){a.FBXLoader=v.a,a.GLTFLoader=b.a;var s=new w.k,h=document.getElementById("three-map");n=new w.rb,(i=new w.Kb).xr.enabled=!0,i.physicallyCorrectLights=!0,i.gammaOutput=!0,i.setPixelRatio(window.devicePixelRatio),i.setSize(h.clientWidth,h.clientHeight),i.sortObjects=!1,h.appendChild(i.domElement),(e=new w.gb(45,h.clientWidth/h.clientHeight,.01,1e3)).setFocalLength=26,window.iotmr.realities={virtual:function(){i.setClearColor("#4285f4",1),n.background=void 0},augmented:function(){i.setClearColor(0,0)},mixed:function(){var e=document.getElementsByTagName("video")[0],t=new w.Jb(e);t.minFilter=w.I,t.magFilter=w.I,t.format=w.ob,n.background=t,i.setClearColor("#4285f4",1)},mixedMRH:function(){i.setClearColor(0,0)}},window.iotmr.realities.virtual(),(t=S()?new f.a(e):new p.a(e,i.domElement)).enableDamping=!1,t.dampingFactor=.05,t.screenSpacePanning=!1,t.minDistance=1,t.maxDistance=1e6,t.rotateSpeed=.8,t.panSpeed=.8,t.zoomSpeed=.8;var g=new w.hb(100,100,99,99);!function(e){for(var t=e.getAttribute("position"),n=t.array,i=2,o=0;i<n.length;i+=3,o++)n[i]=0;t.needsUpdate=!0,e.computeVertexNormals()}(g);var x=new w.W({wireframe:!0,color:"#222",side:w.o});x.flatShading=!0;var y=new w.T(g,x);y.position.set(0,0,0),y.castShadow=!1,y.receiveShadow=!1,y.geometry.rotateX(Math.PI/2);new w.v(1e3,100);var E=new w.a(16777215,1);E.channel=123,n.add(E);var k=new w.n(16777215,1);window.dirLight=k,k.position.set(20,10,20),k.name="dirlight",k.shadowCameraVisible=!0,n.add(k);var D=new w.n(16777215,1);window.dirLight1=D,D.position.set(-17,10,-31),D.name="dirlight1",D.shadowCameraVisible=!0,n.add(D),o=new w.T(new w.vb(.5,32,32),new w.U({color:"red"}));var A=new w.T(new w.vb(150,32,32),new w.U({opacity:0,transparent:!0,alphaTest:.05,side:w.o}));n.add(A);var W=new w.pb,M=new w.Fb,R=function e(t){return!(!t||!window.iotmr.world[window.iotmr.currentWorldId])&&(-1!==window.iotmr.world[window.iotmr.currentWorldId].map((function(e){return e.id})).indexOf(t.uuid)?t:e(t.parent))};function C(){e.aspect=h.clientWidth/h.clientHeight,e.updateProjectionMatrix(),i.setSize(h.clientWidth,h.clientHeight)}return i.setAnimationLoop((function(){t.update(),function(){if(I.a.update(),i.render(n,e),!window.iotmr.world[window.iotmr.currentWorldId])return!0;var t=s.getDelta();window.iotmr.world[window.iotmr.currentWorldId].forEach((function(e){if(e.actions){var n,i=(null===(n=window.iotmr.selected.object)||void 0===n?void 0:n.uuid)==e.id?e.selectedRuntimeInfo:e.runtimeInfo;i&&i.mixer.update(t)}})),window.iotmr.world[window.iotmr.currentWorldId].forEach((function(e){var n,i;if(e.runtimeInfo&&(null===(n=e.actions)||void 0===n||null===(i=n.onLoad)||void 0===i?void 0:i.animations)&&e.object){var o,r,a=j(t,e);if(a)a.position&&(o=e.object.position).set.apply(o,Object(u.a)(a.position)),a.rotation&&(Math.abs(a.rotation[1]-e.object.rotation.y)>Math.PI/2||0==e.smoothRotation?(r=e.object.rotation).set.apply(r,Object(u.a)(a.rotation)):new I.a.Tween(e.object.rotation).to({x:a.rotation[0],y:a.rotation[1],z:a.rotation[2]},100).easing(I.a.Easing.Quadratic.InOut).start())}})),window.iotmr.selected.object&&window.iotmr.selected.objectHelper.update()}()})),window.addEventListener("resize",C,!1),document.getElementById("three-map").addEventListener("click",(function(t){try{var o=function(){if(window.iotmr.listeners.mouseMoved)return{v:!0};window.iotmr.selected.object&&(n.remove(window.iotmr.selected.objectHelper),window.iotmr.selected.object=null,window.iotmr.selected.material=null);var o=i.domElement.getBoundingClientRect();M.x=((t.clientX||t.changedTouches[0].clientX)-o.left)/o.width*2-1,M.y=-((t.clientY||t.changedTouches[0].clientY)-o.top)/o.height*2+1,W.setFromCamera(M,e);var r,a,c=W.intersectObjects(n.children,!0),d=Object(m.a)(c);try{for(d.s();!(a=d.n()).done;){var s=a.value;if(r=R(null===s||void 0===s?void 0:s.object))if(!1!==window.iotmr.world[window.iotmr.currentWorldId].filter((function(e){return e.id==r.uuid}))[0].selectable)break}}catch(v){d.e(v)}finally{d.f()}if(!r)return l(null),{v:!1};new w.W({color:"#b34f0b",side:w.o});window.iotmr.selected.object=r,window.iotmr.selected.objectHelper=new w.f(r),window.iotmr.selected.objectHelper.material.color.set(16777215),n.add(window.iotmr.selected.objectHelper),n.add(window.iotmr.selected.objectHelper);var u=window.iotmr.world[window.iotmr.currentWorldId].filter((function(e){return e.id==r.uuid}))[0],p=u.selectedRuntimeInfo;if(p){p.animationIndex=0,p.pathIndex=0,p.duration=0;var f=new w.c(r);f.clipAction(r.animations.filter((function(e){return e.name==u.actions.onSelect.animations[u.selectedRuntimeInfo.animationIndex].name}))[0]).setDuration((u.actions.onSelect.animations[u.selectedRuntimeInfo.animationIndex].singleLoopDuration||1e3)/1e3).play(),p.mixer=f}l(r.uuid)}();if("object"===typeof o)return o.v}catch(r){console.error(r)}})),O(i,window.vrh,"immersive-vr",n,e),O(i,window.mrh,"immersive-ar",n,e),{plane:y,camera:e,controls:t,scene:n,renderer:i,pointer:o,partials:r,loaders:a,onWindowResize:C}}b.a.prototype.load2=function(e,t){var n=this,i=e[0],o=new FileReader;o.onload=function(e){2!==e.target.readyState&&0!==e.target.status||n.parse(e.target.result||e.target.responseText,"",t)},o.readAsArrayBuffer(i)},v.a.prototype.load2=function(e,t){var n=this,i=e[0],o=new FileReader;o.onload=function(e){if(2===e.target.readyState||0===e.target.status){var i=n.parse(e.target.result||e.target.responseText);t&&t(i)}},o.readAsArrayBuffer(i)};var D=Object(s.b)((function(e){return{api:e.api}}),(function(e){return{setDescriptiveData:function(t){return e({type:"SET_DESCRIPTIVE_DATA",descriptiveData:t})}}}))((function(e){return Object(i.useEffect)((function(){var t=document.getElementById("video");if(e.renderVideo){var n=document.getElementById("video");navigator.mediaDevices.getUserMedia({video:{width:1280,height:720,facingMode:"environment"}}).then((function(e){n.srcObject=e,n.play()}))}else t&&function(e){var t=e.srcObject;t&&(t.getTracks().forEach((function(e){e.stop()})),e.srcObject=null)}(t)}),[e.renderVideo]),Object(i.useEffect)((function(){var t;if(!(null===(t=navigator.mediaDevices)||void 0===t?void 0:t.getUserMedia))return!1;var n=window.iotmr,i=(n.mixers,n.camera),o=n.controls,r=n.scene,a=n.renderer,c=n.pointer,d=n.partials,s=n.loaders,u=(document.getElementById("three-map"),k(i,o,r,a,c,d,s,0,0,(function(t){var n=t?window.iotmr.world[window.iotmr.currentWorldId].filter((function(e){return e.id==t}))[0].description:null;window["descriptive-data-container"].classList.add("transition"),window["descriptive-data-container"].style.height=n?"33%":"0%",setTimeout((function(){window["descriptive-data-container"].classList.remove("transition")}),1e3),e.setDescriptiveData(n)})));window.iotmr=Object(l.a)(Object(l.a)({},window.iotmr),u)}),[]),o.a.createElement("div",{id:"world"},o.a.createElement("video",{key:"video",id:"video",style:{display:"none"},autoPlay:!0,playsInline:!0}),o.a.createElement("div",{id:"three-map",style:{position:"absolute",width:"100%",height:"100%"}}))})),A=function(e,t,n){return function(i){t.current.style.height="100%";var o=function(n){e.current.classList.add("transition"),.33==(e.current.offsetHeight/window.innerHeight).toFixed(2)?e.current.style.height="0%":e.current.style.height="33%",window.removeEventListener("mousemove",r),window.removeEventListener("touchmove",r),window.removeEventListener("mouseup",a),window.removeEventListener("touchend",a),setTimeout((function(){e.current.classList.remove("transition"),t.current.style.height="48px"}),500)};n.current={height:null,movementY:null,previousTouchY:null,previousHeight:e.current.offsetHeight};var r=function(t){n.current.moved=!0,"undefined"===typeof t.movementY?(n.current.movementY=t.touches[0].pageY-(n.current.previousTouchY||t.touches[0].pageY),n.current.previousTouchY=t.touches[0].pageY):n.current.movementY=t.movementY,n.current.height=e.current.offsetHeight-n.current.movementY,e.current.style.height="".concat(n.current.height,"px")};window.addEventListener("mousemove",r),window.addEventListener("touchmove",r);var a=function i(){if(!n.current.moved)return o();e.current.classList.add("transition");var a=n.current.previousHeight-e.current.offsetHeight,c=(e.current.offsetHeight/window.innerHeight).toFixed(2);Number(c)<=.33?n.current.height=a>=0?"0%":"33%":n.current.height=a>=0?"33%":"100%",e.current.style.height="".concat(n.current.height),setTimeout((function(){e.current.classList.remove("transition"),t.current.style.height="48px"}),500),window.removeEventListener("mousemove",r),window.removeEventListener("touchmove",r),window.removeEventListener("mouseup",i),window.removeEventListener("touchend",i)};window.addEventListener("mouseup",a),window.addEventListener("touchend",a)}},W=n(54),M=n(4),R=n(141),C=n(152),N=n(150),L=n(149),T=n(151),F=function(e){var t=Object(R.a)((function(e){return{root:Object(M.a)({pointerEvents:"none",height:380,transform:"translateZ(0px)",flexGrow:1,flex:1,zIndex:10,width:"100%"},"height","100%"),speedDial:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2),"& .MuiSpeedDialAction-staticTooltip .MuiSpeedDialAction-staticTooltipLabel":{whiteSpace:"nowrap"},"& .MuiButtonBase-root.MuiFab-root.MuiSpeedDial-fab.MuiFab-primary":{width:48,height:48,"& .MuiFab-label":{display:"initial"},"&:focus":{outline:"none"}}}}}))(),n=o.a.useState(!1),i=Object(c.a)(n,2),r=i[0],a=i[1],d=function(){a(!1)};return o.a.createElement("div",{className:t.root},o.a.createElement(C.a,{open:r}),o.a.createElement(N.a,{ariaLabel:"Action Tooltip",className:t.speedDial,icon:o.a.createElement(T.a,null),onClose:d,onOpen:function(){a(!0)},open:r},e.actions.map((function(e){return o.a.createElement(L.a,{key:e.name,icon:e.icon,tooltipTitle:e.name,tooltipOpen:!0,onClick:d})}))))},z=n(148),H=Object(R.a)((function(e){return{paper:{position:"absolute",fontFamily:"Ubuntu",width:"98%",height:"98%",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),borderRadius:20,display:"flex",flexFlow:"column"}}})),V=function(e){var t=H(),n=o.a.useState(!1),i=Object(c.a)(n,2),r=(i[0],i[1],o.a.createElement("div",{className:t.paper},e.data));return o.a.createElement(z.a,{open:!0,onClose:e.onClose,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},r)},P=n(16),Y=n.n(P),B=n(23),_=n(76),G=n(61),U=function(e,t,n){var i=t.position,o=t.rotation,r=t.scale,a=t.scaleDifferenceXY,c=t.scaleDifferenceZ,d=(t.blending,e[0].url),l=window.iotmr,s=(l.scene,new l.loaders.GLTFLoader),m=new _.a;return s.setDRACOLoader(m),new Promise((function(e,l){s.load(d,(function(d){d.scene.animations=d.animations;var l=new w.w;if(d.scene.traverse((function(e){e.isMesh&&(e.material.side=w.o,e.material.needsUpdate=!0,e.frustumCulled=!1)})),i[0]instanceof Array){for(var s=new G.a(d.scene,i.length),m=0;m<i.length-1;m++){var p,f=new w.eb;f.frustumCulled=!1;var v={};v.x=Number(o[0]),v.y=Number(o[1]),v.z=Number(o[2]);var b=new w.Gb(1,0,0),h=new w.Gb(0,1,0),g=new w.Gb(0,0,1);f.rotateOnWorldAxis(b,v.x),f.rotateOnWorldAxis(g,v.z),f.rotateOnWorldAxis(h,2*Math.random()*Math.PI);var x=Math.random()*a,y=Math.random()*a+Math.random()*c,E={};E.x=Number(r[0])+x,E.y=Number(r[1])+x,E.z=Number(r[2])+y,f.scale.set(E.x,E.y,E.z),(p=f.position).set.apply(p,Object(u.a)(i[m].reduce((function(e,t,n){return[].concat(Object(u.a)(e),[t-window.iotmr.center[n]])}),[]))),f.updateMatrix(),s.setMatrixAt(m,f.matrix)}l.add(s)}else{var j,I,O;l.add(d.scene),(j=l.position).set.apply(j,Object(u.a)(i.reduce((function(e,t,n){return[].concat(Object(u.a)(e),[t-window.iotmr.center[n]])}),[]))),(I=l.scale).set.apply(I,Object(u.a)(r)),(O=l.rotation).set.apply(O,Object(u.a)(o))}"mapped"==t.type&&(l.renderOrder=999),e({referenceIndex:n,uuid:d.scene.uuid,object:l})}),(function(){}),(function(e){l(e)}))}))},X={gltf:U,glb:U,fbx:function(e,t,n){var i=t.position,o=t.rotation,r=t.scale,a=t.scaleDifferenceXY,c=t.scaleDifferenceZ,d=(t.blending,e[0].url),l=window.iotmr,s=(l.scene,new l.loaders.FBXLoader);return new Promise((function(e,l){s.load(d,(function(d){var l=new w.w;if(d.scene.traverse((function(e){e.isMesh&&(e.material.side=w.o,e.material.needsUpdate=!0,e.frustumCulled=!1)})),i[0]instanceof Array){for(var s=new G.a(d,i.length),m=0;m<i.length-1;m++){var p,f=new w.eb;f.frustumCulled=!1;var v={};v.x=Number(o[0]),v.y=Number(o[1]),v.z=Number(o[2]);var b=new w.Gb(1,0,0),h=new w.Gb(0,1,0),g=new w.Gb(0,0,1);f.rotateOnWorldAxis(b,v.x),f.rotateOnWorldAxis(g,v.z),f.rotateOnWorldAxis(h,2*Math.random()*Math.PI);var x=Math.random()*a,y=Math.random()*a+Math.random()*c,E={};E.x=Number(r[0])+x,E.y=Number(r[1])+x,E.z=Number(r[2])+y,f.scale.set(E.x,E.y,E.z),(p=f.position).set.apply(p,Object(u.a)(i[m].reduce((function(e,t,n){return[].concat(Object(u.a)(e),[t-window.iotmr.center[n]])}),[]))),f.updateMatrix(),s.setMatrixAt(m,f.matrix)}l.add(s)}else{var j,I,O;l.add(d),(j=l.position).set.apply(j,Object(u.a)(i.reduce((function(e,t,n){return[].concat(Object(u.a)(e),[t-window.iotmr.center[n]])}),[]))),(I=l.scale).set.apply(I,Object(u.a)(r)),(O=l.rotation).set.apply(O,Object(u.a)(o))}"mapped"==t.type&&(l.renderOrder=1),e({referenceIndex:n,uuid:l.uuid,object:l})}),(function(){}),(function(e){l(e)}))}))}},q=function(){var e=Object(B.a)(Y.a.mark((function e(t){var n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=function(e){return e.split(/[#?]/)[0].split(".").pop().trim()},Object(W.a)([40.626374,22.948324,15.25]),function(e){window.iotmr.center=e.meta.coordinates;var t=e.content,i=window.iotmr,o=(i.renderer,i.scene,i.camera,[]);if(window.iotmr.world[e.id])return!0;window.iotmr.world[e.id]=[];var r,a=Object(m.a)(t.entries());try{for(a.s();!(r=a.n()).done;){var d=Object(c.a)(r.value,2),l=d[0],s=d[1];-1!==["virtual","mapped"].indexOf(s.type)&&(o.push(X[n(s.url)]([{url:s.url}],s,l)),window.iotmr.world[e.id].push(s))}}catch(u){a.e(u)}finally{a.f()}return Promise.all(o).then((function(e){e.forEach((function(e){window.iotmr.world[window.iotmr.currentWorldId][e.referenceIndex].id=e.uuid,window.iotmr.world[window.iotmr.currentWorldId][e.referenceIndex].object=e.object,window.iotmr.scene.add(e.object),e.object.traverse((function(t){t.isMesh&&(!1===window.iotmr.world[window.iotmr.currentWorldId][e.referenceIndex].visible&&(t.material.opacity=0,t.material.transparent=!0),t.material.flatShading=!1,t.geometry.computeVertexNormals())}));var t=window.iotmr.world[window.iotmr.currentWorldId][e.referenceIndex].actions||{};if((t.onLoad||{}).animations){var n=t.onLoad.animations[0],i=n.startAt||0,o=new w.c(e.object),r=window.iotmr.world[window.iotmr.currentWorldId][e.referenceIndex].object.children[0].animations.filter((function(e){return e.name===n.name}))[0];setTimeout((function(){o.clipAction(r).setDuration((n.singleLoopDuration||1e3)/1e3).play()}),i),window.iotmr.world[window.iotmr.currentWorldId][e.referenceIndex].runtimeInfo={animationIndex:0,pathIndex:0,duration:0,lastUpdate:0,mixer:o}}if((t.onSelect||{}).animations){var a=new w.c(e.object),c=window.iotmr.world[window.iotmr.currentWorldId][e.referenceIndex].object.children[0].animations.filter((function(e){return e.name===t.onSelect.animations[0].name}))[0];a.clipAction(c).setDuration((t.onSelect.animations[0].singleLoopDuration||1e3)/1e3).play(),window.iotmr.world[window.iotmr.currentWorldId][e.referenceIndex].selectedRuntimeInfo={animationIndex:0,pathIndex:0,duration:0,lastUpdate:0,mixer:a}}}))})).catch((function(e){console.error(e)}))}(window.iotmr.worlds.filter((function(e){return e.id===t}))[0]);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function J(e){var t=o.a.useState({selectedId:null}),n=Object(c.a)(t,2),i=n[0],r=n[1];return o.a.createElement(o.a.Fragment,null,e.item.map((function(e){return 0==e.id?o.a.createElement(o.a.Fragment,{key:e.id}):o.a.createElement("div",{key:e.id,className:"world-item",style:{border:e.id===i.selectedId?"1px solid #b34f0b":"1px solid #fff"},onClick:function(){r({selectedId:e.id}),window.iotmr.currentWorldId&&e.id!==window.iotmr.currentWorldId&&window.iotmr.world[window.iotmr.currentWorldId].map((function(e){e.object&&(e.object.visible=!1)})),window.iotmr.currentWorldId=e.id,window.iotmr.center=e.meta.coordinates,window.iotmr.world.hasOwnProperty(e.id)?window.iotmr.world[window.iotmr.currentWorldId].map((function(e){e.object&&(e.object.visible=!0)})):Object(B.a)(Y.a.mark((function t(){return Y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q(e.id);case 2:case"end":return t.stop()}}),t)})))()}},e.meta.thumbnail&&o.a.createElement("img",{src:e.meta.thumbnail,sty:{objectFit:"contain"}}),o.a.createElement("label",null,e.name),o.a.createElement("p",null,e.description))})))}var K=n(82),Q=n.n(K),Z=n(81),$=n.n(Z),ee=n(145),te=n(77),ne=n.n(te);function ie(e){var t=o.a.useState(!0),n=Object(c.a)(t,2),i=n[0],r=n[1],a=function(t){if(t){var n=JSON.parse(t),i=window.iotmr.worlds.filter((function(e){return e.id==n.id}))[0];if(i){window.iotmr.currentWorldId&&i.id!==window.iotmr.currentWorldId&&window.iotmr.world[window.iotmr.currentWorldId].map((function(e){e.object&&(e.object.visible=!1)})),window.iotmr.currentWorldId=i.id,window.iotmr.center=i.meta.coordinates,window.iotmr.world.hasOwnProperty(i.id)?window.iotmr.world[window.iotmr.currentWorldId].map((function(e){e.object&&(e.object.visible=!0)})):Object(B.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(i.id);case 2:case"end":return e.stop()}}),e)})))(),window.iotmr.scene.position.set(window.iotmr.center[0]-n.position.x,window.iotmr.center[1]-n.position.z,window.iotmr.center[2]-n.position.y);var o=new w.Gb,r=new w.wb;window.iotmr.camera.getWorldDirection(o),r.setFromVector3(o);var a=(360-w.P.radToDeg(r.theta)-180).toFixed(0);360==a&&(a=0),a!=n.heading&&"undefined"!==typeof window.iotmr.controls.alphaOffset&&(window.iotmr.controls.alphaOffset-=Number(((n.heading-a)*Math.PI/180).toFixed(4))),window.iotmr.controls.update(),e.onClose()}}};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:25}},o.a.createElement("i",{style:{fontSize:70},className:"fas fa-qrcode"}),o.a.createElement("h2",{style:{marginLeft:24,fontWeight:900,textTransform:"uppercase",color:"#606059",letterSpacing:5},id:"simple-modal-title"},"QR Code Scanner")),o.a.createElement("p",{id:"simple-modal-description",style:{flex:1}},o.a.createElement("div",{style:{height:"calc(100% - 110px)",position:"relative"}},o.a.createElement("div",{className:"scan-tip"},o.a.createElement(ne.a,{delay:300,onError:function(e){},onScan:a,style:{width:"100%"}}))),o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement("p",null,"or type the id of the observation point"),o.a.createElement("input",{onChange:function(e){return r(Object(l.a)(Object(l.a)({},i),{},{observationId:e.target.value}))}}),o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement(ee.a,{style:{fontSize:"18px",color:"#313129",fontWeight:600},onClick:function(){var e,t=i.observationId,n=((null===(e=window.iotmr.worlds)||void 0===e?void 0:e.filter((function(e){return e.id==window.iotmr.currentWorldId})))||[])[0].meta.observationPoints.filter((function(e){return e.pointId==t}));a(JSON.stringify(n[0]))}},"Submit"))),o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement(ee.a,{style:{fontSize:"18px",color:"#313129",fontWeight:600},onClick:e.onClose},"Close"))))}var oe=n(147),re=n(80),ae=n.n(re),ce=n(79),de=new w.Gb,le=Object(s.b)((function(e){return{descriptiveData:e.api.descriptiveData}}),(function(e){return{}}))((function(e){var t,n=Object(i.useRef)(),r=Object(i.useRef)(),a=Object(i.useState)({geolocation:!1,calibration:!1}),d=Object(c.a)(a,2),s=d[0],u=d[1],m=Object(i.useState)(null),p=Object(c.a)(m,2),f=p[0],v=p[1],b=Object(i.useState)({position:{x:0,y:0,z:0},heading:[0]}),h=Object(c.a)(b,2),g=h[0],x=h[1],y=Object(i.useRef)({height:null,movementY:null,previousTouchY:null,moved:!1}),E=Object(i.useState)(!0),j=Object(c.a)(E,2),I=j[0],O=j[1],S=0!==window.iotmr.currentWorldId&&(null===(t=window.iotmr.worlds.filter((function(e){return window.iotmr.currentWorldId===e.id}))[0])||void 0===t?void 0:t.actions);o.a.useEffect((function(){if(s.geolocation){var e,t;({latitude:0,longitude:0}),t={enableHighAccuracy:!1,timeout:5e3,maximumAge:0},e=navigator.geolocation.watchPosition((function(t){if(!window.iotmr.camera.position)return!1;var n=t.coords.latitude,i=t.coords.longitude,o=Object(W.a)([n,i,0]),r=Number((o[0]-window.iotmr.center[0]).toFixed(4)),a=Number(window.iotmr.camera.position.y.toFixed(4)),c=Number((o[1]-window.iotmr.center[2]).toFixed(4));if(Math.abs(r)>1e3||Math.abs(c)>1e3){var d=Math.sqrt(Math.pow(r,2)+Math.pow(c,2));return alert("Your location is to far from the virtual world. You are ".concat(d.toFixed(2)," meter far away.")),u(Object(l.a)(Object(l.a)({},s),{},{geolocation:!1})),navigator.geolocation.clearWatch(e),!0}window.iotmr.camera.position.set(r,a,c)}),(function(e){console.warn("ERROR("+e.code+"): "+e.message)}),t)}}),[s.geolocation]),o.a.useEffect((function(){setInterval((function(){if(!window.iotmr.camera.position)return!1;var e=window.iotmr.camera.position,t=e.x,n=e.y,i=e.z,o=new w.Gb,r=new w.wb;window.iotmr.camera.getWorldDirection(o),r.setFromVector3(o);var a=(360-w.P.radToDeg(r.theta)-180).toFixed(0);360==a&&(a=0);var d=Object(c.a)(window.iotmr.center,3),l=d[0],s=d[1],u=d[2];x({position:{x:(l+t).toFixed(2)+"m",y:(u+i).toFixed(2)+"m",z:(s+n).toFixed(2)+"m"},heading:a+"deg"})}),1e3)}),[]);var k=Object(i.useState)("Adjust"),D=Object(c.a)(k,2),M=D[0],R=D[1],C=Object(i.useRef)(),N=Object(i.useRef)();function L(e){window.iotmr.camera.getWorldDirection(de),window.iotmr.camera.position.addScaledVector(de,e)}return o.a.createElement("div",{id:"controls"},o.a.createElement("div",{id:"actions-menu"},o.a.createElement(F,{actions:[{icon:o.a.createElement("div",{style:e.renderVideo?{}:{pointerEvents:"none"},onClick:function(){return v(o.a.createElement(ie,{onClose:function(e){v(null)}}))}},o.a.createElement("i",{style:{fontSize:18},className:"fas fa-qrcode"})),name:"QR Scan",disabled:!e.renderVideo},{icon:o.a.createElement("span",{onClick:function(){u(Object(l.a)(Object(l.a)({},s),{},{calibration:!s.calibration}))},id:"calibration"},o.a.createElement(ae.a,null)),name:"Calibrate"},{icon:o.a.createElement($.a,{onClick:function(){document.fullscreenElement?document.exitFullscreen():window.document.body.requestFullscreen().catch((function(e){alert("Error attempting to enable full-screen mode: ".concat(e.message," (").concat(e.name,")"))}))}}),name:"Full Screen"},{icon:o.a.createElement("span",{onClick:function(){e.setRenderVideo(!1),window.iotmr.realities.virtual()}},"VR"),name:"Virtual Reality"},{icon:o.a.createElement("span",{onClick:function(){e.setRenderVideo(!0),window.iotmr.realities.mixed()}},"MR"),name:"Mixed Reality"},{icon:o.a.createElement("span",{onClick:function(){e.setRenderVideo(!1),window.iotmr.realities.virtual()},id:"vrh"},"VRH"),name:"VR Headset"},{icon:o.a.createElement("span",{style:e.renderVideo?{pointerEvents:"none",textDecoration:"line-through"}:{},onClick:function(){e.setRenderVideo(!1),window.iotmr.realities.mixedMRH()},id:"mrh"},"MRH"),name:"MR Headset",disabled:e.renderVideo},{icon:o.a.createElement("span",{onClick:function(){O(!I)},id:"shi"},o.a.createElement("i",{className:"fas fa-info-circle"})),name:"Show/Hide Info"},{icon:o.a.createElement("span",{onClick:function(){u(Object(l.a)(Object(l.a)({},s),{},{geolocation:!s.geolocation}))},id:"geolocation"},o.a.createElement(Q.a,null)),name:"Geolocate"}]}),s.calibration&&o.a.createElement(oe.a,{style:{position:"absolute",width:"100%",height:"100%",top:"0px",left:"0px",zIndex:100,background:"rgba(0,0,0,0.4)",display:"flex",gap:"12px",pointerEvents:"auto",alignItems:"flex-end",justifyContent:"space-between",padding:"50px"}},o.a.createElement(oe.a,{style:{background:"rgba(0,0,0,0.7)",color:"white",padding:"8px 12px",borderRadius:"6px",cursor:"pointer"},onClick:function(){return R("Adjust"===M?"Move":"Adjust")}},M),o.a.createElement(ce.Joystick,{size:100,baseColor:"#323229",stickColor:"#b64f0c",move:function(e){"Adjust"==M?window.iotmr.controls.alphaOffset-=.001*e.x/50:("FORWARDS"!==C.current&&e.y>0&&(C.current="FORWARDS",clearInterval(N.current),N.current=setInterval((function(){L(.1)}),60)),"BACKWARDS"!==C.current&&e.y<0&&(C.current="BACKWARDS",clearInterval(N.current),N.current=setInterval((function(){L(-.1)}),60)))},stop:function(){clearInterval(N.current)}}),o.a.createElement(oe.a,{style:{background:"rgba(0,0,0,0.7)",color:"white",padding:"8px 12px",borderRadius:"6px",cursor:"pointer"},onClick:function(){return u(Object(l.a)(Object(l.a)({},s),{},{calibration:!1}))}},"Close")),I&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"info-panel"},o.a.createElement("div",{className:"info-group"},o.a.createElement("label",null,"Position"),o.a.createElement("div",null,"".concat(g.position.x,",").concat(g.position.y,",").concat(g.position.z))),o.a.createElement("div",{className:"info-group"},o.a.createElement("label",null,"Heading"),o.a.createElement("div",null,g.heading))),o.a.createElement("div",{id:"available-worlds"},o.a.createElement(J,{item:window.iotmr.worlds}))),o.a.createElement("div",{id:"descriptive-data-container",ref:function(e){return r.current=e}},o.a.createElement(ee.a,{id:"slider-helper",onMouseDown:A(r,n,y),onTouchStart:A(r,n,y),ref:function(e){return n.current=e}}),o.a.createElement("div",{id:"slider"}),S&&o.a.createElement("div",{className:"world-actions"},S.map((function(e){return o.a.createElement("div",{key:e.name,className:"world-action",onClick:e.run},e.name)}))),e.descriptiveData?o.a.createElement("div",{id:"descriptive-data",dangerouslySetInnerHTML:{__html:e.descriptiveData}}):o.a.createElement("div",{id:"descriptive-data",style:{overflowY:"auto"}},o.a.createElement("i",{className:"mm-icons far fa-comment-dots"}),o.a.createElement("p",null,"Please select an object to reveal descriptive data"))),f&&o.a.createElement(V,{data:f,onClose:function(){v(null)}})))})),se=n(84),ue=Object(se.a)({palette:{primary:{main:"#b34f0b"},secondary:{main:"#323228"}}});var me=function(){var e=o.a.useState(!1),t=Object(c.a)(e,2),n=t[0],i=t[1];return o.a.createElement(d.a,{theme:ue},o.a.createElement("div",{className:"App"},o.a.createElement(D,{renderVideo:n}),o.a.createElement(le,{renderVideo:n,setRenderVideo:function(e){return i(e)}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var we=n(32),pe=n(83),fe=(n(117),{currentAction:"immerse",descriptiveData:null}),ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DESCRIPTIVE_DATA":var n=t.descriptiveData;return Object.assign({},e,{descriptiveData:n});default:return e}},be={id:"006cb9aE-S32A",name:"Test World",description:"",content:[{type:"virtual",ground:!0,selectable:!1,url:"/IoT-MR/light-switch.glb",position:[0,1.7,0],rotation:[Math.PI/2,0,0],scale:[10,10,10],description:""}],meta:{authors:[{firstName:"Konstantinos",lastName:"Evanggelidis"},{firstName:"Theofilos",lastName:"Papadopoulos"}],thumbnail:"".concat("/IoT-MR","/worldThree-Thumbnail.png"),coordinates:[0,0,0],observationPoints:[{id:"006cb9aE-S32A",pointId:1,position:{x:0,y:-2.5,z:1.7},heading:230}]}};window.iotmr={modelLayer:[],vectors:[],plane:{},sky:{},mixers:[],camera:{},controls:{},scene:{},renderer:{},pointer:{},partials:{},loaders:{},selected:{object:null,material:null},listeners:{mouseMoved:!1},center:[0,0,0],onWindowResize:function(){},world:{},currentWorldId:0,worlds:[{id:"0",name:"Start World",description:"Start World",content:[],meta:{authors:[{firstName:"Konstantinos",lastName:"Evanggelidis"},{firstName:"Theofilos",lastName:"Papadopoulos"}],coordinates:[0,0,0]}},be]};var he=Object(we.b)({api:ve}),ge=document.getElementById("root"),xe=(Object(pe.createLogger)({}),Object(we.c)(he,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()));a.a.render(o.a.createElement(s.a,{store:xe},o.a.createElement(me,null)),ge),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},95:function(e,t,n){e.exports=n(118)}},[[95,1,2]]]);
//# sourceMappingURL=main.ee127649.chunk.js.map